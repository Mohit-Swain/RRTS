# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'cleark.ui'
#
# Created by: PyQt5 UI code generator 5.15.2
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from views.dialog import CustomDialog
import DB
class Ui_ClerkWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(503, 604)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        font = QtGui.QFont()
        font.setPointSize(10)
        self.centralwidget.setFont(font)
        self.centralwidget.setObjectName("centralwidget")
        self.clerkLabel = QtWidgets.QLabel(self.centralwidget)
        self.clerkLabel.setGeometry(QtCore.QRect(200, 10, 81, 41))
        font = QtGui.QFont()
        font.setPointSize(15)
        font.setBold(True)
        font.setWeight(75)
        self.clerkLabel.setFont(font)
        self.clerkLabel.setObjectName("clerkLabel")
        self.formLayoutWidget = QtWidgets.QWidget(self.centralwidget)
        self.formLayoutWidget.setGeometry(QtCore.QRect(80, 110, 341, 111))
        self.formLayoutWidget.setObjectName("formLayoutWidget")
        self.formLayout = QtWidgets.QFormLayout(self.formLayoutWidget)
        self.formLayout.setContentsMargins(0, 0, 0, 0)
        self.formLayout.setObjectName("formLayout")
        self.label = QtWidgets.QLabel(self.formLayoutWidget)
        self.label.setObjectName("label")
        self.formLayout.setWidget(0, QtWidgets.QFormLayout.LabelRole, self.label)
        self.locationInput = QtWidgets.QLineEdit(self.formLayoutWidget)
        self.locationInput.setObjectName("locationInput")
        self.formLayout.setWidget(0, QtWidgets.QFormLayout.FieldRole, self.locationInput)
        self.label_2 = QtWidgets.QLabel(self.formLayoutWidget)
        self.label_2.setObjectName("label_2")
        self.formLayout.setWidget(1, QtWidgets.QFormLayout.LabelRole, self.label_2)
        self.startingPointInput = QtWidgets.QLineEdit(self.formLayoutWidget)
        self.startingPointInput.setObjectName("startingPointInput")
        self.formLayout.setWidget(1, QtWidgets.QFormLayout.FieldRole, self.startingPointInput)
        self.label_3 = QtWidgets.QLabel(self.formLayoutWidget)
        self.label_3.setObjectName("label_3")
        self.formLayout.setWidget(2, QtWidgets.QFormLayout.LabelRole, self.label_3)
        self.endingPointInput = QtWidgets.QLineEdit(self.formLayoutWidget)
        self.endingPointInput.setObjectName("endingPointInput")
        self.formLayout.setWidget(2, QtWidgets.QFormLayout.FieldRole, self.endingPointInput)
        self.label_4 = QtWidgets.QLabel(self.centralwidget)
        self.label_4.setGeometry(QtCore.QRect(190, 70, 121, 21))
        font = QtGui.QFont()
        font.setPointSize(10)
        font.setUnderline(True)
        self.label_4.setFont(font)
        self.label_4.setObjectName("label_4")
        self.line = QtWidgets.QFrame(self.centralwidget)
        self.line.setGeometry(QtCore.QRect(140, 240, 221, 16))
        self.line.setFrameShape(QtWidgets.QFrame.HLine)
        self.line.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line.setObjectName("line")
        self.line_2 = QtWidgets.QFrame(self.centralwidget)
        self.line_2.setGeometry(QtCore.QRect(0, 50, 501, 16))
        self.line_2.setFrameShape(QtWidgets.QFrame.HLine)
        self.line_2.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line_2.setObjectName("line_2")
        self.label_5 = QtWidgets.QLabel(self.centralwidget)
        self.label_5.setGeometry(QtCore.QRect(180, 260, 121, 21))
        font = QtGui.QFont()
        font.setPointSize(10)
        font.setUnderline(True)
        self.label_5.setFont(font)
        self.label_5.setObjectName("label_5")
        self.formLayoutWidget_2 = QtWidgets.QWidget(self.centralwidget)
        self.formLayoutWidget_2.setGeometry(QtCore.QRect(80, 310, 341, 141))
        self.formLayoutWidget_2.setObjectName("formLayoutWidget_2")
        self.formLayout_2 = QtWidgets.QFormLayout(self.formLayoutWidget_2)
        self.formLayout_2.setContentsMargins(0, 0, 0, 0)
        self.formLayout_2.setObjectName("formLayout_2")
        self.label_6 = QtWidgets.QLabel(self.formLayoutWidget_2)
        self.label_6.setObjectName("label_6")
        self.formLayout_2.setWidget(0, QtWidgets.QFormLayout.LabelRole, self.label_6)
        self.nameInput = QtWidgets.QLineEdit(self.formLayoutWidget_2)
        self.nameInput.setObjectName("nameInput")
        self.formLayout_2.setWidget(0, QtWidgets.QFormLayout.FieldRole, self.nameInput)
        self.label_7 = QtWidgets.QLabel(self.formLayoutWidget_2)
        self.label_7.setObjectName("label_7")
        self.formLayout_2.setWidget(1, QtWidgets.QFormLayout.LabelRole, self.label_7)
        self.govIdInput = QtWidgets.QLineEdit(self.formLayoutWidget_2)
        self.govIdInput.setObjectName("govIdInput")
        self.formLayout_2.setWidget(1, QtWidgets.QFormLayout.FieldRole, self.govIdInput)
        self.label_8 = QtWidgets.QLabel(self.formLayoutWidget_2)
        self.label_8.setObjectName("label_8")
        self.formLayout_2.setWidget(2, QtWidgets.QFormLayout.LabelRole, self.label_8)
        self.addressInput = QtWidgets.QLineEdit(self.formLayoutWidget_2)
        self.addressInput.setObjectName("addressInput")
        self.formLayout_2.setWidget(2, QtWidgets.QFormLayout.FieldRole, self.addressInput)
        self.label_9 = QtWidgets.QLabel(self.formLayoutWidget_2)
        self.label_9.setObjectName("label_9")
        self.formLayout_2.setWidget(3, QtWidgets.QFormLayout.LabelRole, self.label_9)
        self.phoneNoInput = QtWidgets.QLineEdit(self.formLayoutWidget_2)
        self.phoneNoInput.setValidator(QtGui.QIntValidator())
        self.phoneNoInput.setObjectName("phoneNoInput")
        self.formLayout_2.setWidget(3, QtWidgets.QFormLayout.FieldRole, self.phoneNoInput)

        self.submitButton = QtWidgets.QPushButton(self.centralwidget)
        self.submitButton.setGeometry(QtCore.QRect(340, 490, 93, 28))
        self.submitButton.setObjectName("submitButton")
        self.submitButton.clicked.connect(lambda :self.makeComplain())

        self.resetButton = QtWidgets.QPushButton(self.centralwidget)
        self.resetButton.setGeometry(QtCore.QRect(80, 490, 93, 28))
        self.resetButton.setObjectName("resetButton")
        self.resetButton.clicked.connect(lambda : self.resetInputs())

        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 503, 26))
        self.menubar.setObjectName("menubar")
        self.menumenu = QtWidgets.QMenu(self.menubar)
        self.menumenu.setObjectName("menumenu")
        self.menuabout = QtWidgets.QMenu(self.menubar)
        self.menuabout.setObjectName("menuabout")
        MainWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(MainWindow)
        self.statusbar.setObjectName("statusbar")
        MainWindow.setStatusBar(self.statusbar)
        self.actiondevelopers = QtWidgets.QAction(MainWindow)
        self.actiondevelopers.setObjectName("actiondevelopers")
        self.menuabout.addAction(self.actiondevelopers)
        self.menubar.addAction(self.menumenu.menuAction())
        self.menubar.addAction(self.menuabout.menuAction())

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "clerk main"))
        self.clerkLabel.setText(_translate("MainWindow", "Clerk"))
        self.label.setText(_translate("MainWindow", "Location of road :"))
        self.label_2.setText(_translate("MainWindow", "Starting point :"))
        self.label_3.setText(_translate("MainWindow", "Ending point :"))
        self.label_4.setText(_translate("MainWindow", "About Road"))
        self.label_5.setText(_translate("MainWindow", "About Resident"))
        self.label_6.setText(_translate("MainWindow", "Name :"))
        self.label_7.setText(_translate("MainWindow", "GovtId :"))
        self.label_8.setText(_translate("MainWindow", "Address :"))
        self.label_9.setText(_translate("MainWindow", "PhoneNo :"))
        self.submitButton.setText(_translate("MainWindow", "Submit"))
        self.resetButton.setText(_translate("MainWindow", "Reset"))
        self.menumenu.setTitle(_translate("MainWindow", "menu"))
        self.menuabout.setTitle(_translate("MainWindow", "about"))
        self.actiondevelopers.setText(_translate("MainWindow", "developers"))

    def resetInputs(self):
        self.nameInput.clear()
        self.govIdInput.clear()
        self.addressInput.clear()
        self.phoneNoInput.clear()

        self.locationInput.clear()
        self.startingPointInput.clear()
        self.endingPointInput.clear()

    def makeComplain(self):
        name = self.nameInput.text()
        idCardNo = self.govIdInput.text()
        address = self.addressInput.text()
        phoneNo = self.phoneNoInput.text()

        roadLoc = self.locationInput.text()
        startingPoint = self.startingPointInput.text()
        endingPoint = self.endingPointInput.text()


        missing = []
        if not name: missing.append('name')
        if not idCardNo: missing.append('GovtId')
        if not address: missing.append('Address')
        if not phoneNo: missing.append('phoneNo')
        phoneNo = int(phoneNo)
        if not roadLoc: missing.append('roadLoc')
        if not startingPoint or not endingPoint: missing.append('start/end point')
        if len(missing) > 0:
            msg = CustomDialog.init_message('Values Missing', '{0} is/are Missing'.format(' ,'.join(missing)), 'critical')
            msg.exec_()
        else:
            try:
                resId = DB.residentTable.insertNewResident(name,idCardNo,address,phoneNo)
                compId = DB.complainTable.makeComplaint(resId,roadLoc,startingPoint,endingPoint)
                msg = CustomDialog.init_message('Success', 'New Complaint registed successfully,with CompId: {0}'.format(compId))
                msg.exec_()
            except Exception as e:
                msg = CustomDialog.init_message('DB Error', str(e), 'critical')
                msg.exec_()

        

def launchClerk():
    import sys
    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_ClerkWindow()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec_())

if __name__ == "__main__":
    launchClerk()
